<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.0</version>
    <template_groups>
        <template_group>
            <uuid>1b51b0147ea64b04b3f2c0edbc9fc8c0</uuid>
            <name>OS</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>d29b468371734516b44ff67a2718653d</uuid>
            <template>Windows Agent</template>
            <name>Windows Agent</name>
            <description>Modelo para Windows. Requer o agente Zabbix 7.0 ou superior.</description>
            <groups>
                <group>
                    <name>OS</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>cbe3ab9ad4244c0aaaaac8b4ee131d62</uuid>
                    <name>Zabbix agent ping</name>
                    <key>agent.ping</key>
                    <delay>10s</delay>
                    <description>Verifica se o agente Zabbix no host está ativo. Dispara alerta se não responder.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>86f324d1e0c449b0937e7c278ef517f5</uuid>
                            <expression>last(/Windows Agent/agent.ping)=0</expression>
                            <name>Agente não responde</name>
                            <priority>AVERAGE</priority>
                            <description>Dispara se o host não responder ao ping do Zabbix Agent. Importante para monitoramento de conectividade.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>agent</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <uuid>6785dd8382104468b0a15dfd5c48a063</uuid>
                            <expression>last(/Windows Agent/agent.ping)=0</expression>
                            <name>Agent ping Teste 1</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                        </trigger>
                        <trigger>
                            <uuid>a22011dd4177476ab67f99235720281c</uuid>
                            <expression>last(/Windows Agent/agent.ping)&lt;&gt;0</expression>
                            <name>Serviço Zabbix Agent está parado</name>
                            <priority>HIGH</priority>
                            <description>Dispara se o agente Zabbix não está respondendo. Pode indicar host offline ou problema de rede.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>agent</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>Zabbix</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <uuid>9d7086599b814d46b534b37fe2f05811</uuid>
                            <expression>last(/Windows Agent/agent.ping)=1</expression>
                            <name>Teste Alerta</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                            <type>MULTIPLE</type>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>a6e011cf720941c498fd0e9614cd491f</uuid>
                    <name>EventLog - Application Error (ID 1000)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,Error,,1000]</key>
                    <delay>30s</delay>
                    <value_type>LOG</value_type>
                    <trends>0</trends>
                    <description>Detecta falha de aplicativos críticos. Útil para monitorar travamentos de serviços ou software crítico.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                        <tag>
                            <tag>eventlog</tag>
                            <value>1000</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>57a9c2c8572449b2b32fe4c70b6b8ca9</uuid>
                            <expression>last(/Windows Agent/eventlog[Application,,Error,,1000])&lt;&gt;0</expression>
                            <name>Falha de Aplicativo detectada (EventID 1000)</name>
                            <priority>WARNING</priority>
                            <description>Dispara quando algum aplicativo crítico falha (ID 1000). Ajuda a identificar serviços/parâmetros que precisam de correção.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>eventlog</tag>
                                    <value>1000</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>0a9e3ab5e9d0426a907d1f14e39b0b2a</uuid>
                    <name>EventLog - Kernel Power (ID 41)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,Critical,,41]</key>
                    <delay>30s</delay>
                    <value_type>LOG</value_type>
                    <trends>0</trends>
                    <description>Detecta reinicializações inesperadas ou quedas de energia, indicando risco de perda de dados.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system,</value>
                        </tag>
                        <tag>
                            <tag>eventlog</tag>
                            <value>41</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>4e257a018d084ac2bf59e37ed501c92c</uuid>
                            <expression>last(/Windows Agent/eventlog[System,,Critical,,41])&lt;&gt;0</expression>
                            <name>Reinicialização inesperada / Queda de energia (EventID 41)</name>
                            <priority>HIGH</priority>
                            <description>Indica desligamento inesperado ou queda de energia. Importante para rastrear perda de dados ou falhas de hardware.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>system</value>
                                </tag>
                                <tag>
                                    <tag>eventlog</tag>
                                    <value>41</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>a15fc697085b45059777fdf6eb735101</uuid>
                    <name>EventLog - Bad Block (ID 7)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,Error,,7]</key>
                    <delay>30s</delay>
                    <value_type>LOG</value_type>
                    <trends>0</trends>
                    <description>Indica setores defeituosos em HD/SSD. Ação recomendada: backup e verificação de disco.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>disk</value>
                        </tag>
                        <tag>
                            <tag>eventlog</tag>
                            <value>7</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>e1f4fe09c7a940799df6c75ee7417ec6</uuid>
                            <expression>last(/Windows Agent/eventlog[System,,Error,,7])&lt;&gt;0</expression>
                            <name>Falha de disco detectada (Bad Block - EventID 7)</name>
                            <priority>DISASTER</priority>
                            <description>Dispara quando o Windows registra erro de Bad Block. Pode indicar setores defeituosos no HD/SSD. Ação imediata: backup + verificar disco.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>disk</value>
                                </tag>
                                <tag>
                                    <tag>eventlog</tag>
                                    <value>7</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>13e32c8c676b480bb73bca6eb502095d</uuid>
                    <name>EventLog - Virtual Memory Error (ID 2020/2021)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,Error,,2020,2021]</key>
                    <delay>30s</delay>
                    <value_type>LOG</value_type>
                    <trends>0</trends>
                    <description>Sistema sem memória virtual ou memória de pool não paginada, podendo travar Windows.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>eventlog</tag>
                            <value>2020/2021</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>03665e5616044073a99296dfc0d83775</uuid>
                            <expression>last(/Windows Agent/eventlog[System,,Error,,2020,2021])&lt;&gt;0</expression>
                            <name>Falta de memória virtual (EventID 2020/2021)</name>
                            <priority>DISASTER</priority>
                            <description>Dispara quando o sistema está sem memória virtual (2020) ou memória de pool não paginada (2021). Pode travar o Windows.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>memory</value>
                                </tag>
                                <tag>
                                    <tag>eventlog</tag>
                                    <value>2020/2021</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>6d12445462f5406fbf0e988f11e2a145</uuid>
                    <name>Cache bytes</name>
                    <key>perf_counter_en[&quot;\Memory\Cache Bytes&quot;]</key>
                    <units>B</units>
                    <description>Quantidade de memória cache em uso. Pode ajudar a identificar consumo excessivo de memória.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1395793f8bc74ccfa5cf3c60cbcba129</uuid>
                    <name>Memory pool non-paged</name>
                    <key>perf_counter_en[&quot;\Memory\Pool Nonpaged Bytes&quot;]</key>
                    <units>B</units>
                    <description>Memória não paginada em uso. Uso elevado pode indicar vazamento de memória de drivers.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>b860dce8600447e5851234655f66bb56</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Memory\Pool Nonpaged Bytes&quot;])&gt;524288000</expression>
                            <name>Memória não paginada alta (&gt;500MB)</name>
                            <priority>AVERAGE</priority>
                            <description>Dispara quando a memória não paginada ultrapassa 500MB. Pode indicar vazamento de memória de drivers.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>memory</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>500MB</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>294ab721449d4b2b8c3a4f5f80e41cdb</uuid>
                    <name>Used swap space in %</name>
                    <key>perf_counter_en[&quot;\Paging file(_Total)\% Usage&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Percentual de uso do arquivo de paginação. Uso alto pode indicar falta de memória RAM.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>e593bf2c550f468785feb40a4dcf5c62</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Paging file(_Total)\% Usage&quot;])&gt;70</expression>
                            <name>Uso de Swap acima de 70%</name>
                            <priority>AVERAGE</priority>
                            <description>Dispara quando o arquivo de paginação ultrapassa 70% de uso. Pode indicar falta de memória física.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>memory</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>70%</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>c3712c042bdc4431af4d1f0d3287f567</uuid>
                    <name>CPU DPC time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% DPC Time&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Tempo gasto em rotinas DPC (Deferred Procedure Call). Valores altos indicam drivers ou hardware gerando overhead.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>dcf8c7769be046f8823ef94a4d34dc4d</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Processor Information(_total)\% DPC Time&quot;])&gt;5</expression>
                            <name>CPU DPC Time anormal</name>
                            <priority>AVERAGE</priority>
                            <description>Tempo gasto em Deferred Procedure Calls (DPC) acima de 5%. Pode indicar que drivers ou hardware estão causando overhead na CPU, afetando performance.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>metric</tag>
                                    <value>DPC Time</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>3a139c6aa75e469b87fbd0ff7e0c5ec0</uuid>
                    <name>CPU interrupt time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Percentual de tempo gasto com interrupções de hardware. Valores altos indicam possível problema de dispositivo.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>fb1349434de74fe8a73d95001eb08d90</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;])&gt;5</expression>
                            <name>CPU Interrupt Time alta</name>
                            <priority>AVERAGE</priority>
                            <description>Percentual de tempo gasto com interrupções de hardware acima de 5%. Pode indicar problemas em dispositivos ou drivers que geram muitas interrupções.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>metric</tag>
                                    <value>Interrupt Time</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>d586f35719104e2b9d01cc3f4a43753b</uuid>
                    <name>CPU privileged time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Percentual de tempo da CPU em modo kernel. Valores altos podem indicar processos pesados ou drivers problemáticos.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>cb43d46f471349e798090c9990856b02</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;])&gt;70</expression>
                            <name>CPU Privileged Time alta</name>
                            <priority>HIGH</priority>
                            <description>Percentual da CPU em modo kernel acima de 70%. Valores altos podem indicar drivers ou processos problemáticos que impactam a performance do sistema.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>metric</tag>
                                    <value>Privileged Time</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <uuid>fee2a5565d0d44289edff96054dd6fd0</uuid>
                            <expression>last(/Windows Agent/perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;])&gt;80</expression>
                            <name>CPU User Time alta</name>
                            <priority>HIGH</priority>
                            <description>Percentual da CPU em modo usuário acima de 80%. Indica processos pesados que estão consumindo muitos recursos do processador.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>metric</tag>
                                    <value>User Time</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>7cd662aba17e48fd961e8dd19637d125</uuid>
                    <name>CPU user time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% User Time&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Percentual de tempo da CPU executando código em modo usuário. Alta utilização indica processos intensivos em CPU.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1d47e283a0c0409cb0dd412016ded78b</uuid>
                    <name>CPU queue length</name>
                    <key>perf_counter_en[&quot;\System\Processor Queue Length&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <description>Número de threads esperando por CPU. Valores altos por muito tempo indicam gargalo de processamento.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>fc1cd7a0275b480aaa53e374f8dc633c</uuid>
                            <expression>avg(/Windows Agent/perf_counter_en[&quot;\System\Processor Queue Length&quot;],5m)&gt;5</expression>
                            <name>Alta fila de processador (&gt;5) por 5 minutos</name>
                            <priority>AVERAGE</priority>
                            <description>Dispara se a fila de CPU estiver acima de 5 por 5 minutos. Indica gargalo de processamento.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>5</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>42d47118592e4d47936a1697c7115e08</uuid>
                    <name>Number of processes</name>
                    <key>proc.num[]</key>
                    <description>Número total de processos ativos. Pode ser usado para detectar excesso de processos ou loops infinitos.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>326cce9078934db3ae99c9020be6e195</uuid>
                            <expression>last(/Windows Agent/proc.num[])&gt;=100</expression>
                            <name>Numero de Processos passou de 100</name>
                            <priority>AVERAGE</priority>
                            <description>Dispara quando a quantidade de processos ativos excede 100. Pode indicar software rodando em excesso.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>os</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>100</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>66a78252c81d45ca8b4164e409a110db</uuid>
                    <name>Status do serviço Spooler</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Spooler,state]</key>
                    <description>Indica se o serviço de impressão está rodando. Parado pode impactar impressão e dependências de software.</description>
                    <valuemap>
                        <name>Valores do service.info</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <uuid>0d070642afa847d0a55e9fb87329cfd4</uuid>
                            <expression>last(/Windows Agent/service.info[Spooler,state])&lt;&gt;4</expression>
                            <name>Spooler parado</name>
                            <priority>HIGH</priority>
                            <description>Dispara se o serviço de impressão Spooler não está rodando. Impacta impressões e dependências de software.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>service</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>Spooler</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>e9f90a7a24254a0aa209ef1cd6c28894</uuid>
                    <name>CPU utilization</name>
                    <key>system.cpu.util</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Utilização total da CPU. Alta utilização contínua pode indicar necessidade de investigação de processos.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>dc75b26fde384468b9be07db0d7560cc</uuid>
                            <expression>avg(/Windows Agent/system.cpu.util,5m)&gt;90</expression>
                            <name>Alta utilização de CPU (&gt;90%) por 5 minutos</name>
                            <priority>HIGH</priority>
                            <description>Dispara se a CPU estiver acima de 90% por 5 minutos contínuos. Ajuda a identificar processos pesados ou loop infinito.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>90%</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>cd8b9b8f31e44d679dd1c4fb6fcf9dbf</uuid>
                    <name>System name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <description>Nome do host no Windows. Útil para inventário e identificação de host.</description>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>328128d9d2904036b8ab672fb0628590</uuid>
                    <name>System local time</name>
                    <key>system.localtime</key>
                    <units>unixtime</units>
                    <description>Hora local do sistema. Útil para correlação de logs e eventos.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>186d54fa95884c719acf8b4f6455cab6</uuid>
                    <name>Operating system architecture</name>
                    <key>system.sw.arch</key>
                    <delay>1h</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <description>Arquitetura do sistema (x86/x64).</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>445f305ec49045ddb59c534cffeedddf</uuid>
                    <name>Operating system</name>
                    <key>system.sw.os</key>
                    <delay>1h</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <description>Versão e edição do Windows.</description>
                    <inventory_link>OS</inventory_link>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e71a5cd9f2244a9fa63f496549c6bcf7</uuid>
                    <name>Total swap space</name>
                    <key>system.swap.size[,total]</key>
                    <units>B</units>
                    <description>Tamanho total do arquivo de paginação.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0286042c325e4a948db15a9ef240f328</uuid>
                    <name>System description</name>
                    <key>system.uname</key>
                    <delay>15m</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <description>Descrição completa do sistema, incluindo hostname, versão e arquitetura.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e8e6f4775d0c43f7a8a451797164509c</uuid>
                    <name>Uptime</name>
                    <key>system.uptime</key>
                    <delay>10s</delay>
                    <trends>0</trends>
                    <units>uptime</units>
                    <description>Tempo que o host está ligado. Pode ser usado para detectar reinicializações recentes.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>aa8898f2786a4a9aacc846c0534efe2b</uuid>
                            <expression>last(/Windows Agent/system.uptime)&lt;300</expression>
                            <name>Ativo a 5min</name>
                            <priority>INFO</priority>
                            <description>Dispara se o host está ligado há menos de 5 minutos. Ajuda a rastrear boot recente.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>system</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <uuid>7f0b9c8366d64400a71df385b6f71544</uuid>
                            <expression>change(/Windows Agent/system.uptime)&gt;0 and last(/Windows Agent/system.uptime)&lt;600</expression>
                            <name>Sistema reiniciado (uptime menor que 10 min)</name>
                            <priority>INFO</priority>
                            <description>Dispara quando o host foi reiniciado recentemente (menos de 10 minutos). Útil para validar reinicializações.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>system</value>
                                </tag>
                                <tag>
                                    <tag>event</tag>
                                    <value>restart</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>0f90b20a4af94d7989234d306dc824ac</uuid>
                    <name>Total memory</name>
                    <key>vm.memory.size[total]</key>
                    <units>B</units>
                    <description>Quantidade total de RAM instalada no host.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e11b02d40a23490e86a83d63d217bc9a</uuid>
                    <name>Used memory</name>
                    <key>vm.memory.size[used]</key>
                    <units>B</units>
                    <description>Quantidade de memória RAM atualmente em uso.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>982afc523c7c47e98dec50fe7f46e675</uuid>
                    <name>Memory utilization</name>
                    <type>CALCULATED</type>
                    <key>vm.memory.util</key>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(//vm.memory.size[used]) / last(//vm.memory.size[total]) * 100</params>
                    <description>Percentual de memória RAM utilizada.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>b4bc23e973944905aeeb546a081596c3</uuid>
                            <expression>last(/Windows Agent/vm.memory.util)&gt;90</expression>
                            <name>Utilização de memória &gt;90%</name>
                            <priority>HIGH</priority>
                            <description>Dispara quando o consumo de memória ultrapassa 90%. Pode causar lentidão ou travamentos.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>memory</value>
                                </tag>
                                <tag>
                                    <tag>threshold</tag>
                                    <value>90%</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>89b263ee0288488eba4ef537b659b627</uuid>
                    <name>Number of cores</name>
                    <key>wmi.get[root/cimv2,&quot;Select NumberOfLogicalProcessors from Win32_ComputerSystem&quot;]</key>
                    <description>Número de núcleos lógicos da CPU.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>41ebad0928d94192ac2c5df60480cb2a</uuid>
                    <name>Descoberta automática de interfaces de rede</name>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <status>DISABLED</status>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>.*</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFGUID}</macro>
                                <value>.*</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>.*</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SPEED}</macro>
                                <value>.*</value>
                                <formulaid>D</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Descobre automaticamente todas as interfaces físicas de rede ativas nos hosts monitorados via agente Zabbix (ativo) e cria dinamicamente os protótipos de itens e triggers correspondentes, garantindo monitoramento consistente de tráfego, status e pacotes por interface.

Todos os protótipos utilizam macros LLD:

{#IFNAME} → nome do adaptador

{#IFDESCR} → descrição da interface

{#SPEED} → velocidade nominal da interface

Alterações nos thresholds dos protótipos de triggers devem ser avaliadas considerando a capacidade real da rede para evitar falsos positivos.

Novos adaptadores de rede adicionados aos hosts serão automaticamente monitorados sem necessidade de intervenção manual.

Recomenda-se não duplicar itens do template original fora da descoberta, para evitar conflitos.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>e799b37974f548b28fa2687ffc3383fa</uuid>
                            <name>Pacotes de entrada</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.in[pkts,{#IFNAME}]</key>
                            <units>pacotes/s</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>2453aa58ba9b4174971ef71c9155d791</uuid>
                                    <expression>change(/Windows Agent/net.if.in[pkts,{#IFNAME}])&lt;0</expression>
                                    <name>Pacotes de entrada muito baixos em {#IFNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Detecta queda súbita na recepção de pacotes na interface.

- Pacotes de entrada com queda brusca (entrada &lt; esperado)</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>02d40f9b598d472a9a472c62a72c94d0</uuid>
                                    <expression>rate(/Windows Agent/net.if.in[pkts,{#IFNAME}],5m)&gt;100000</expression>
                                    <name>Tráfego de entrada alto em {#IFNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Detecta aumento anormal no tráfego de entrada.

- Pacotes recebidos muito altos (possível flood ou tráfego anormal)</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>08b9abed246a46bda07cddd50833bfe2</uuid>
                            <name>Tráfego de entrada</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.in[{#IFNAME}]</key>
                            <units>bps</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>0f61eba0c12047edadc2f86359f1256e</uuid>
                                    <expression>avg(/Windows Agent/net.if.in[{#IFNAME}],5m)&lt;1000</expression>
                                    <name>Tráfego de entrada abaixo do mínimo em {#IFNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Detecta baixa utilização (útil para interfaces críticas)</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>bc4f7e6df51f4c4681040f3e1edc8c63</uuid>
                                    <expression>avg(/Windows Agent/net.if.in[{#IFNAME}],5m)&gt;100000000</expression>
                                    <name>Tráfego de entrada alto em {#IFNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Alerta se a entrada &gt; 100 Mbps</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>aa550ca5415246e993a4887d52f90cae</uuid>
                            <name>Pacotes de saída</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.out[pkts,{#IFNAME}]</key>
                            <units>pacotes/s</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>629035deb688481e8a7c91fc478813c3</uuid>
                                    <expression>change(/Windows Agent/net.if.out[pkts,{#IFNAME}])&lt;0</expression>
                                    <name>Pacotes de saída muito baixos em {#IFNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Detecta queda súbita na transmissão de pacotes na interface.

- Pacotes de saída com queda brusca (saída &lt; esperado)</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>781c39445d0f492b996758726a65b5e4</uuid>
                                    <expression>rate(/Windows Agent/net.if.out[pkts,{#IFNAME}],5m)&gt;100000</expression>
                                    <name>Tráfego de saída alto em {#IFNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Detecta aumento anormal no tráfego de saída.

- Pacotes enviados muito altos (possível flood ou tráfego anormal)</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cdbb092b5b42469b827365f0ac52529b</uuid>
                            <name>Tráfego de saída</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.out[{#IFNAME}]</key>
                            <units>bps</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>af793efcaba34c9a88edc95a126f1b2b</uuid>
                                    <expression>avg(/Windows Agent/net.if.out[{#IFNAME}],5m)&lt;1000</expression>
                                    <name>Tráfego de saída abaixo do mínimo em {#IFNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Detecta baixa utilização</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>2af986ec34bf45d09f63926754f94ad1</uuid>
                                    <expression>avg(/Windows Agent/net.if.out[{#IFNAME}],5m)&gt;100000000</expression>
                                    <name>Tráfego de saída alto em {#IFNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Alerta se a saída &gt; 100 Mbps</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cdd08887e12843a98dfd82dd94603975</uuid>
                            <name>Status da interface</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.status[{#IFNAME}]</key>
                            <units>0/1</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>2b0f4ca9d4204b64a440b35e6d26de57</uuid>
                                    <expression>last(/Windows Agent/net.if.status[{#IFNAME}])=2</expression>
                                    <name>Interface {#IFNAME} inativa</name>
                                    <priority>AVERAGE</priority>
                                    <description>Detecta interfaces desconectadas</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#IFDESCR}</lld_macro>
                            <path>$[*].{#IFDESCR}</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#IFGUID}</lld_macro>
                            <path>$[*].{#IFGUID}</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#IFNAME}</lld_macro>
                            <path>$[*].{#IFNAME}</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SPEED}</lld_macro>
                            <path>$[*].{#SPEED}</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>6ff4a2547a854d8fac15ce962b6c5ec2</uuid>
                    <name>Descoberta de serviços Windows</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SERVICE.DISPLAYNAME}</macro>
                                <value>(?i)(Telemetry|Update|Installer|Hotfix|Driver|Adobe|Google|OneDrive|Teams)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.NAME}</macro>
                                <value>^(WinDefend|wuauserv|Spooler|BITS|EventLog|MSSQL.*|W3SVC|Backup.*|AV.*|SQLAgent.*)$</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.STARTMODE}</macro>
                                <value>(Auto|Manual)</value>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>monitorar serviços que importam, tipo:

Serviços de sistema críticos: WinDefend, wuauserv (Windows Update), Spooler (impressão), BITS (Background Intelligent Transfer), EventLog.

Serviços de aplicação: bancos de dados (MSSQL*), IIS (W3SVC), serviços de backup, antivírus corporativo, etc.

Serviços que impactam a disponibilidade ou segurança.

Evitar:

Serviços temporários de instalação, telemetry, atualização de apps de terceiros que mudam sempre de nome.

Serviços não essenciais que geram alerta a todo momento.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>7fe8f432c889409490fcf65f640d4ed4</uuid>
                            <name>Serviço iniciado {#SERVICE.DISPLAYNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>service.info[{#SERVICE.NAME},startmode]</key>
                            <description>Indica o modo de inicialização configurado do serviço {#SERVICE.DISPLAYNAME}.

Valores possíveis:

Automático (2)

Manual (3)

Desativado (4)

Objetivo: Garantir que serviços críticos estão configurados para iniciar automaticamente ou manualmente conforme esperado, evitando falhas de disponibilidade após reinicializações.

Observações: Serviços que deveriam ser sempre automáticos, mas estão em manual, podem gerar alertas de atenção.</description>
                            <valuemap>
                                <name>Modo de inicialização (service.info[{#SERVICE.NAME},startmod)</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>service</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>09d153770cb04e7e991c4a2cde233aef</uuid>
                                    <expression>last(/Windows Agent/service.info[{#SERVICE.NAME},startmode])&lt;&gt;2</expression>
                                    <name>Serviço {#SERVICE.DISPLAYNAME} não inicia automaticamente</name>
                                    <priority>AVERAGE</priority>
                                    <description>Dispara se o serviço não estiver configurado como Automático (2 = Auto).</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>dd7a62fb38c847a483971f1c24713b85</uuid>
                            <name>Status do serviço {#SERVICE.DISPLAYNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>service.info[{#SERVICE.NAME},state]</key>
                            <description>Monitora o estado atual do serviço {#SERVICE.DISPLAYNAME} no host Windows.

Valores possíveis:

Parando (1)

Parado (2)

Iniciando (3)

Iniciado (4)

Objetivo: Detectar se o serviço está parado ou falhando, permitindo alertas imediatos de indisponibilidade de serviços críticos de sistema ou aplicação.

Observações: Ideal para serviços como WinDefend, wuauserv, Spooler, EventLog, bancos de dados ou servidores IIS.</description>
                            <valuemap>
                                <name>Status do serviço (service.info[{#SERVICE.NAME},state])</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>service</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>a5ee4e8e21eb4aa89040696b8519f066</uuid>
                                    <expression>last(/Windows Agent/service.info[{#SERVICE.NAME},state])&lt;&gt;4</expression>
                                    <name>Serviço {#SERVICE.DISPLAYNAME} parado</name>
                                    <priority>HIGH</priority>
                                    <description>Dispara se o serviço não estiver em execução (4 = Running).</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>339422e2f8c74e95b4c9452381aab927</uuid>
                    <name>Descoberta de sistemas de arquivos</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vfs.fs.dependent.discovery</key>
                    <status>DISABLED</status>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>CD-ROM</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>Rede</value>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Descobre automaticamente todos os sistemas de arquivos montados nos hosts monitorados via agente Zabbix (ativo) e cria protótipos de itens e triggers correspondentes, garantindo monitoramento consistente de espaço e uso de inodes.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>b07456f6ce754d0eb8254d0514c842b5</uuid>
                            <name>Inodes livres em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.inodes[{#FSNAME},free]</key>
                            <units>inodes</units>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f7e2a676cfc5483d9097447b19a80769</uuid>
                            <name>Uso percentual de inodes em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.inodes[{#FSNAME},pused]</key>
                            <units>%</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>4c9baa42c82649bdb67a042b89b3f8b9</uuid>
                                    <expression>avg(/Windows Agent/vfs.fs.inodes[{#FSNAME},pused],5m)&gt;95</expression>
                                    <name>Inodes quase cheios em {#FSNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Crítico para inodes</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>e4f63cfb0b694e2ca7563a83590dc358</uuid>
                                    <expression>avg(/Windows Agent/vfs.fs.inodes[{#FSNAME},pused],5m)&gt;85</expression>
                                    <name>Inodes usados alto em {#FSNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Se o FS tiver inodes limitados</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>df9e997f164b46a8ae697e1b3e1a055e</uuid>
                            <name>Inodes usados em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.inodes[{#FSNAME},used]</key>
                            <units>inodes</units>
                            <description>Opcional, se o FS suporta inodes</description>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4cebf40446c0402ea92ad093fdd4eb8d</uuid>
                            <name>Espaço livre em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},free]</key>
                            <units>bytes</units>
                            <description>Espaço disponível</description>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f757c02f1f264b7ca7a70980982efa59</uuid>
                            <name>Uso percentual de {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},pused]</key>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>Percentual usado</description>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>b109718af1c144f3bfac395dd8faecf1</uuid>
                                    <expression>avg(/Windows Agent/vfs.fs.size[{#FSNAME},pused],5m)&gt;95</expression>
                                    <name>Espaço quase cheio em {#FSNAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Alerta crítico quando uso ultrapassa 95%</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>c76380302a9e40268fda5dc7a89fb09e</uuid>
                                    <expression>avg(/Windows Agent/vfs.fs.size[{#FSNAME},pused],5m)&gt;85</expression>
                                    <name>Espaço usado alto em {#FSNAME}</name>
                                    <priority>AVERAGE</priority>
                                    <description>Alerta quando uso ultrapassa 85%</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ed0d8636785b458f8edc060058407858</uuid>
                            <name>Espaço total em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <units>bytes</units>
                            <description>Tamanho total do FSystem</description>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b329846118354b3385ea02dfff7f7de6</uuid>
                            <name>Espaço usado em {#FSNAME}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <units>bytes</units>
                            <description>Espaço em uso</description>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#FSLABEL}</lld_macro>
                            <path>$.label</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#FSNAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#FSTYPE}</lld_macro>
                            <path>$.type</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>// Recebe o JSON bruto do agente
// Exemplo do que o vfs.fs.dependent.discovery retorna:
// [
//   {&quot;fsname&quot;:&quot;/&quot;,&quot;fstype&quot;:&quot;ext4&quot;,&quot;bytes&quot;:{&quot;total&quot;:500000000,&quot;used&quot;:300000000,&quot;free&quot;:200000000,&quot;pused&quot;:60}},
//   {&quot;fsname&quot;:&quot;/home&quot;,&quot;fstype&quot;:&quot;ext4&quot;,&quot;bytes&quot;:{&quot;total&quot;:1000000000,&quot;used&quot;:400000000,&quot;free&quot;:600000000,&quot;pused&quot;:40}}
// ]

var discovered = []; // array final que será retornado para o LLD

// Percorre cada filesystem retornado pelo agente
for (var i = 0; i &lt; value.length; i++) {
    var fs = value[i];

    // Ignorar sistemas que não queremos monitorar (opcional)
    if (fs.fstype === &quot;tmpfs&quot; || fs.fstype === &quot;devtmpfs&quot;) {
        continue;
    }

    // Monta o objeto que o Zabbix espera
    discovered.push({
        &quot;{#FSNAME}&quot;: fs.fsname,
        &quot;{#FSTYPE}&quot;: fs.fstype,
        &quot;{#FSLABEL}&quot;: fs.fsname.replace(/\//g, &quot;_&quot;) // para criar labels válidos
    });
}

// Retorna o array final para o Zabbix
return JSON.stringify(discovered);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>os</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>windows</value>
                </tag>
            </tags>
            <dashboards>
                <dashboard>
                    <uuid>3f85a75afb6849849c7db9bae9c6b03c</uuid>
                    <name>Novo dashboard</name>
                    <pages>
                        <page>
                            <name>Geral Windows</name>
                            <display_period>30</display_period>
                            <widgets>
                                <widget>
                                    <type>actionlog</type>
                                    <width>27</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>ACTION</type>
                                            <name>actionids.0</name>
                                            <value>
                                                <name>Report problems to Zabbix administrators</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rf_rate</name>
                                            <value>30</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>statuses.0</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>statuses.1</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>statuses.2</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>USER</type>
                                            <name>userids.0</name>
                                            <value>
                                                <username>Admin</username>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>hostnavigator</type>
                                    <x>27</x>
                                    <width>17</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>group_by.0.attribute</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>group_by.1.attribute</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>maintenance</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>problems</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>LFFLC</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.0</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.1</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.2</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.3</name>
                                            <value>3</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.4</name>
                                            <value>4</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.5</name>
                                            <value>5</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>problems</type>
                                    <x>44</x>
                                    <width>28</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>FIYIS</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.0</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.1</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.2</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.3</name>
                                            <value>3</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.4</name>
                                            <value>4</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>severities.5</name>
                                            <value>5</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show_opdata</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show_suppressed</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show_symptoms</name>
                                            <value>1</value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>5974a6dbccff4ced85a0228cb7a48683</uuid>
                    <name>Modo de inicialização (service.info[{#SERVICE.NAME},startmod)</name>
                    <mappings>
                        <mapping>
                            <value>2</value>
                            <newvalue>Automático</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Manual</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Desativado</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>cb7113de7f524fb7b87b4dba1a505b19</uuid>
                    <name>Status do serviço (service.info[{#SERVICE.NAME},state])</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Parando</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Parado</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Iniciando</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Iniciado</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>2382bde9dfae45c8a2914a71d8cdc0fc</uuid>
                    <name>Valores do service.info</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Unknown</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Stopped</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Starting</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Stopping</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Running</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>Continue Pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>Pause Pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>Paused</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>0d152aa0b39141b6a55fb7fcead10e58</uuid>
            <name>cpu</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Windows Agent</host>
                        <key>system.cpu.util</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>fcc31bc01ddc47e3b09c59bc8c170a9a</uuid>
            <name>Numero de Processos</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Windows Agent</host>
                        <key>proc.num[]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>76bb0c6092c148eaa027fd404c9398e3</uuid>
            <name>Uso da CPU e da Memoria</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Windows Agent</host>
                        <key>system.cpu.util</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Windows Agent</host>
                        <key>vm.memory.util</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
